(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[29],{"0eyN":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("mXGw");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=new Map,c=new WeakMap,s=0,l=void 0;function d(e){return Object.keys(e).sort().filter((function(t){return void 0!==e[t]})).map((function(t){return t+"_"+("root"===t?(n=e.root)?(c.has(n)||(s+=1,c.set(n,s.toString())),c.get(n)):"0":e[t]);var n})).toString()}function u(e,t,n,r){if(void 0===n&&(n={}),void 0===r&&(r=l),"undefined"===typeof window.IntersectionObserver&&void 0!==r){var i=e.getBoundingClientRect();return t(r,{isIntersecting:r,target:e,intersectionRatio:"number"===typeof n.threshold?n.threshold:0,time:0,boundingClientRect:i,intersectionRect:i,rootBounds:i}),function(){}}var o=function(e){var t=d(e),n=a.get(t);if(!n){var r,i=new Map,o=new IntersectionObserver((function(t){t.forEach((function(t){var n,o=t.isIntersecting&&r.some((function(e){return t.intersectionRatio>=e}));e.trackVisibility&&"undefined"===typeof t.isVisible&&(t.isVisible=o),null==(n=i.get(t.target))||n.forEach((function(e){e(o,t)}))}))}),e);r=o.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:o,elements:i},a.set(t,n)}return n}(n),c=o.id,s=o.observer,u=o.elements,b=u.get(e)||[];return u.has(e)||u.set(e,b),b.push(t),s.observe(e),function(){b.splice(b.indexOf(t),1),0===b.length&&(u.delete(e),s.unobserve(e)),0===u.size&&(s.disconnect(),a.delete(c))}}var b=["children","as","tag","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function h(e){return"function"!==typeof e.children}var p=function(e){var t,n;function a(t){var n;return(n=e.call(this,t)||this).node=null,n._unobserveCb=null,n.handleNode=function(e){n.node&&(n.unobserve(),e||n.props.triggerOnce||n.props.skip||n.setState({inView:!!n.props.initialInView,entry:void 0})),n.node=e||null,n.observeNode()},n.handleChange=function(e,t){e&&n.props.triggerOnce&&n.unobserve(),h(n.props)||n.setState({inView:e,entry:t}),n.props.onChange&&n.props.onChange(e,t)},n.state={inView:!!t.initialInView,entry:void 0},n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var c=a.prototype;return c.componentDidUpdate=function(e){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold&&e.skip===this.props.skip&&e.trackVisibility===this.props.trackVisibility&&e.delay===this.props.delay||(this.unobserve(),this.observeNode())},c.componentWillUnmount=function(){this.unobserve(),this.node=null},c.observeNode=function(){if(this.node&&!this.props.skip){var e=this.props,t=e.threshold,n=e.root,r=e.rootMargin,i=e.trackVisibility,o=e.delay,a=e.fallbackInView;this._unobserveCb=u(this.node,this.handleChange,{threshold:t,root:n,rootMargin:r,trackVisibility:i,delay:o},a)}},c.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},c.render=function(){if(!h(this.props)){var e=this.state,t=e.inView,n=e.entry;return this.props.children({inView:t,entry:n,ref:this.handleNode})}var o=this.props,a=o.children,c=o.as,s=o.tag,l=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(o,b);return r.createElement(c||s||"div",i({ref:this.handleNode},l),a)},a}(r.Component);function f(e){var t=void 0===e?{}:e,n=t.threshold,i=t.delay,o=t.trackVisibility,a=t.rootMargin,c=t.root,s=t.triggerOnce,l=t.skip,d=t.initialInView,b=t.fallbackInView,h=r.useRef(),p=r.useState({inView:!!d}),f=p[0],j=p[1],g=r.useCallback((function(e){void 0!==h.current&&(h.current(),h.current=void 0),l||e&&(h.current=u(e,(function(e,t){j({inView:e,entry:t}),t.isIntersecting&&s&&h.current&&(h.current(),h.current=void 0)}),{root:c,rootMargin:a,threshold:n,trackVisibility:o,delay:i},b))}),[Array.isArray(n)?n.toString():n,c,a,s,l,o,b,i]);Object(r.useEffect)((function(){h.current||!f.entry||s||l||j({inView:!!d})}));var O=[g,f.inView,f.entry];return O.ref=O[0],O.inView=O[1],O.entry=O[2],O}p.displayName="InView",p.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1}},ChOw:function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var r=n("oYCi"),i=n("NthX"),o=n.n(i),a=n("eijD"),c=n("aNYv"),s=n("mXGw"),l=n("u9PO"),d=n("ByLR"),u=n("gBOI"),b=n("DK0r"),h=n("dAGg"),p=n.n(h),f=n("/wep"),j=n("b2pr"),g=n("mK0O"),O=n("dV/x"),m=n("NWgQ"),y=n.n(m),v=n("B5kz"),x=n("5dyF"),w=n.n(x),k=n("0eyN"),I=n("oV6d"),S=n("fudW"),C=n("eZYV"),V=n("Nhdc"),D=n("IDQp");function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=function(e){var t,n=e.categoryId,i=e.templateId,c=e.imageId,u=e.canvasSize,b=e.mocking,p=e.refetch,j=void 0!==p&&p,m=e.showAsUserTemplate,x=void 0!==m&&m,P=Object(O.a)(e,["categoryId","templateId","imageId","canvasSize","mocking","refetch","showAsUserTemplate"]),R=Object(h.useRouter)(),_=Object(k.a)({triggerOnce:!0}),E=_.ref,z=_.inView,A=Object(C.d)(),N=Object(s.useState)(!1),U=N[0],T=N[1],W=Object(s.useState)(!1),H=W[0],F=W[1],B=Object(l.a)({base:!0,md:!1}),G=Object(s.useCallback)((function(){return y.a.stringify({tid:i,iid:c},{skipNull:!0})}),[c,i]),L=Object(v.useQuery)(["template",i,c,!0],Object(a.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.stringify((t={},Object(g.a)(t,"image-id",c),Object(g.a)(t,"res","thumbnail"),t),{skipNull:!0}),e.next=3,A(f.a.get("/templates/".concat(i,"?").concat(n)),{skipErrorHandling:function(e,t){return"IMAGE_ID_ERROR"===(null===t||void 0===t?void 0:t.code)}});case 3:return null!==(r=e.sent)&&void 0!==r&&r.apiErrors&&"IMAGE_ID_ERROR"===r.apiErrors[0].code&&R.replace("/design-not-found"),e.abrupt("return",r.data.data);case 6:case"end":return e.stop()}}),e)}))),{enabled:!b,refetchOnMount:j}),J=L.isLoading,Y=L.data,Q=Object(s.useRef)(null),X=Object(s.useRef)(null),K=Object(s.useRef)(null),q=Object(s.useMemo)((function(){return[C.a.AUTOMATE]}),[]),Z=Object(C.e)({template:Y,imageId:c,templateElem:null!==(t=null===K||void 0===K?void 0:K.current)&&void 0!==t?t:void 0,canvasSize:u,renameModalRef:Q,deleteModalRef:X,mock:q});function $(){F(!1)}function ee(e){e===C.a.AUTOMATE&&(F(!0),Object(I.b)("automate_from_preview","website_automation"))}return Object(r.jsx)(w.a,{passHref:!U,href:b?"":x?"/templates/".concat(i).concat(c?"?iid="+c:""):n?"/categories/".concat(n,"?").concat(G()):"",children:Object(r.jsxs)(d.i,{_hover:{textDecoration:"none"},onClick:function(){Object(I.b)("select_design","image",!1)},mr:4,mb:4,children:[Object(r.jsx)(V.ConditionalWrapper,{condition:!B&&!c&&Y,wrapper:function(e){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(V.RenameModal,{ref:Q,template:Y}),Object(r.jsx)(V.DeleteModal,{ref:X,template:Y}),Object(r.jsx)(V.AutomationModal,{template:Y,open:H,onClose:$}),Object(r.jsx)(V.ContextMenu,{elements:Z,onOpenChange:function(e){return T(e)},onActionComplete:ee,children:e})]})},children:Object(r.jsx)(S.a,M({ref:K,containerRef:E,transition:"box-shadow .1s linear",loading:J||b,template:Y,canvasSize:u,shouldRender:z},P))}),Object(r.jsx)(d.o,{isTruncated:!0,width:Object(D.a)(u).width,height:{base:"14px",lg:"16px"},fontSize:{base:"xx-small",lg:"xs"},color:"gray.500",children:Y&&Y.name})]})})},_=n("DdxA");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=Object(s.forwardRef)((function(e,t){var n=e.icon,i=e.text,o=e.previewThumbnailUrl,a=e.children,c=Object(O.a)(e,["icon","text","previewThumbnailUrl","children"]);return Object(r.jsxs)(_.a,z(z({ref:t,display:"flex",flexDir:"column",p:1,"aria-label":i,fontSize:"2rem",variant:"unstyled",borderWidth:"1px",borderStyle:"solid",borderColor:"palette.2",borderRadius:0,whiteSpace:"normal",color:"palette.2",_hover:{bgColor:"palette.2",color:"white"}},c),{},{children:[o?Object(r.jsx)(b.b,{maxWidth:"50%",maxHeight:"30%",alt:"",src:o,mb:2}):n,Object(r.jsx)(d.o,{fontSize:{base:"xs",md:"sm"},children:i}),a]}))})),N=n("Fcif"),U=n("UO5U"),T=n("6h0R"),W=n("7Hz8");function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(){var e=Object(U.a)(["\n    0% {\n        transform: scale3d(1.0);\n        opacity: 1;\n    }\n    25% {\n        transform: scale3d(0.5);\n        opacity: 0;\n    }\n    50% {\n        transform: scale3d(1.0);\n        opacity: 1;\n    }\n    75% {\n        transform: scale3d(0.5);\n        opacity: 0;\n    }\n    100% {\n        -webkit-transform: scale3d(1.0);\n        opacity: 1;\n    }\n"]);return B=function(){return e},e}function G(){for(var e=50;40<e&&e<60||e>95;)e=100*Math.random();return e}var L=Object(T.c)(B()),J=Object(W.d)(b.a,{baseStyle:{position:"absolute",width:"15px",height:"15px",opacity:0,animation:"".concat(L," 2s linear 0s infinite normal")}}),Y=function(e){var t=Object(N.a)({},e);return Object(r.jsx)(d.a,F(F({position:"absolute"},t),{},{children:Array.from({length:25}).map((function(e,t){return Object(r.jsx)(J,{src:"/glitter.svg",top:G()+"%",left:G()+"%",style:{animationDelay:.5+Math.random()+"s"}},t)}))}))},Q=n("/JLY"),X=n("4lgx"),K=n("Bs/J"),q=function(e){var t=e.mocking,n=void 0!==t&&t,i=e.imageId,h=e.categories,g=e.previewImage,O=e.userTemplates,m=Object(l.a)({base:{width:100,height:100},md:{width:120,height:120},lg:{width:135,height:135}}),v=Object(s.useState)(),x=v[0],k=v[1],S=Object(C.d)(),V=Object(X.useSession)(),D=Object(c.a)(V,1)[0],P=Object(l.a)({base:"2rem",md:"2.5rem",lg:"3rem"}),M=Object(s.useMemo)((function(){return y.a.stringifyUrl({url:"/templates/new",query:{iid:i}})}),[i]);function _(e){return m?{width:m.width*e.aspectRatio,height:m.height}:{width:100,height:100}}return Object(s.useEffect)((function(){function e(){return(e=Object(a.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(f.a.get("/images/".concat(i)),{skipErrorHandling:function(e){var t;return 404===(null===(t=e.response)||void 0===t?void 0:t.status)}});case 2:t=e.sent,n=t.data,404===t.status?p.a.replace("/design-not-found"):n.data&&(r=n.data,k(r.backgroundRemovedThumbnailUrl?r.backgroundRemovedThumbnailUrl:r.originalThumbnailUrl));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!n&&i?function(){e.apply(this,arguments)}():k(void 0)}),[n,i,S]),Object(r.jsxs)(d.e,{flexDirection:"column",pt:n||i?"60px":"80px",height:"100%",width:"100%",children:[(n||i)&&Object(r.jsxs)(d.a,{backgroundColor:"white",pb:3,px:6,mb:3,children:[Object(r.jsx)(d.e,{"data-hj-suppress":"true",justifyContent:"center",alignItems:"center",pt:10,pb:8,children:Object(r.jsx)(u.a,{isLoaded:Boolean(!n&&x||n&&g),display:"flex",justifyContent:"center",alignItems:"center",width:{base:"100%",lg:300},height:{base:200,lg:300},children:n?Object(r.jsxs)(d.a,{position:"relative",display:"inline-block",children:[Object(r.jsx)(Y,{width:"100%",height:"100%"}),Object(r.jsx)(b.a,{maxWidth:{base:"100%",lg:300},maxHeight:{base:200,lg:300},alt:"",src:g})]}):Object(r.jsx)(b.b,{alt:"",maxWidth:{base:"100%",lg:300},maxHeight:{base:200,lg:300},src:x})})}),Object(r.jsx)(d.o,{fontSize:{base:"2xl",lg:"3xl"},fontFamily:"Poppins",fontWeight:"700",color:"gray.900",children:n?"Generating designs...":"Select design"})]}),m?Object(r.jsxs)(d.a,{flex:"1",pb:8,children:[D&&O&&O.length>0&&Object(r.jsxs)(d.a,{mb:4,children:[Object(r.jsx)(d.a,{mb:4,mx:6,children:Object(r.jsx)(d.h,{as:"h3",fontFamily:"Poppins",fontWeight:"700",fontSize:"md",color:"gray.900",children:"My Designs"})}),Object(r.jsxs)(d.e,{wrap:"wrap",pl:6,children:[O.map((function(e){return Object(r.jsx)(R,{mocking:!1,refetch:!0,showAsUserTemplate:!0,categoryId:e.categoryId,templateId:e.id,name:e.name,imageId:i,canvasSize:_(e)},e.id)})),Object(r.jsx)(w.a,{passHref:!0,href:M,children:Object(r.jsx)(d.i,{_hover:{textDecoration:"none"},children:Object(r.jsx)(A,{text:"New Design",icon:Object(r.jsx)(Q.c,{size:P}),previewThumbnailUrl:x,width:m.width,height:m.height})})})]})]}),h.map((function(e){return Object(r.jsxs)(d.a,{mb:4,children:[Object(r.jsx)(d.a,{mb:2,mx:6,children:"loadingMockCategory"===e.name?Object(r.jsx)(u.a,{isLoaded:!1,width:"140px",height:"20px",mb:3}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(d.h,{as:"h3",fontFamily:"Poppins",fontWeight:"700",fontSize:"md",color:"gray.900",children:e.name}),!i&&e.description&&Object(r.jsx)(d.o,{fontSize:"xs",color:"gray.500",mt:1,mb:3,children:e.description})]})}),Object(r.jsx)(d.e,{wrap:"wrap",pl:6,children:e.templates&&e.templates.map((function(t){return Object(r.jsx)(R,{mocking:"loadingMockTemplate"===t.name,categoryId:e.id,templateId:t.id,name:t.name,imageId:i,canvasSize:_(t)},t.id)}))})]},e.id)})),O&&0===O.length&&Object(r.jsxs)(d.a,{mb:4,children:[Object(r.jsx)(d.a,{mb:4,mx:6,children:Object(r.jsx)(d.h,{as:"h3",fontFamily:"Poppins",fontWeight:"700",fontSize:"md",color:"gray.900",children:"My Designs"})}),Object(r.jsxs)(d.e,{wrap:"wrap",pl:6,children:[!D&&Object(r.jsx)(d.e,{width:1.5*m.width+16,height:m.height,bgColor:"white",mr:4,mb:4,alignItems:"center",borderColor:"gray.300",borderWidth:"1px",borderStyle:"solid",children:Object(r.jsxs)(d.a,{height:"min-content",mx:{base:8,md:10,lg:12},textAlign:"center",fontSize:{base:"xs",md:"sm"},children:[Object(r.jsx)(d.i,{_hover:{textDecoration:"none"},color:"palette.2",onClick:function(){Object(I.b)("signup","user",!1),Object(K.b)("kaleido")},children:"Login"})," ","or"," ",Object(r.jsx)(d.i,{_hover:{textDecoration:"none"},color:"palette.2",onClick:function(){Object(I.b)("signup","user",!1),Object(K.b)("kaleido",null,{form:"signup"})},children:"Sign Up"})," ","to save designs"]})}),Object(r.jsx)(w.a,{passHref:!0,href:M,children:Object(r.jsx)(d.i,{_hover:{textDecoration:"none"},children:Object(r.jsx)(A,{text:"New Design",icon:Object(r.jsx)(Q.c,{size:P}),previewThumbnailUrl:x,width:m.width,height:m.height})})})]})]})]}):Object(r.jsx)(d.a,{minHeight:"600px"}),Object(r.jsx)(j.a,{pt:"6",backgroundColor:"white"})]})}}}]);